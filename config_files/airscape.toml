# CONFIG FILE FOR COPD V1 vs IPF ANALYSIS

log_level = "INFO" # Logging detail level. Options: DEBUG, INFO, WARNING, ERROR, CRITICAL
seed = 19960915    # Random seed for reproducibility

# IO CONFIGURATION
[io]

base_dir = "/rds/general/user/sep22/projects/phenotypingsputumasthmaticsaurorawellcomea1/live/Sara_Patti/009_ST_Xenium"
# Root directory of the project. All other paths are interpreted relative to this.

data_dir = "data"
# Folder (inside base_dir) containing input data.

xenium_dir = "xenium_raw"
# Subdirectory (inside data_dir) containing raw Xenium output files.

output_data_dir = "out"
# Folder (inside data_dir) where processed/intermediate data will be written.

adata_dir = "adata"
# Subdirectory (inside output_data_dir) for storing AnnData (.h5ad) objects.

zarr_dir = "xenium.zarr"
# Directory (inside output_data_dir) where Zarr-formatted Xenium data will be stored.

output_dir = "airscape_analysis"
# Folder (inside base_dir) where all pipeline output (plots, logs, results) is stored.

area_path = "selected_cells_stats.csv"
# Path (inside data_dir) to the CSV file that contains per-cell area statistics.

logging_dir = "logs"
# Subdirectory (inside output_dir) where log files will be saved.

ref_path = "/rds/general/user/sep22/home/Projects/_Public_datasets/HLCA/data/hlca_full_processed.h5ad"
# Full path to the HLCA reference dataset used for annotation.

gene_id_dict_path = "/rds/general/user/sep22/projects/phenotypingsputumasthmaticsaurorawellcomea1/live/Sara_Patti/009_ST_Xenium/data/gene_id_dict.csv"
# Full path to a CSV mapping Ensembl IDs to gene symbols. Must contain:
#   - index column: ensembl_id
#   - column: gene_symbol

# FORMAT DATA MODULE
#[modules.format_data]
# module_name = "format" # Name of the module - will be used in the output directory name


# QUALITY CONTROL MODULE
#[modules.quality_control]
#module_name = "quality_control" # Name of the module - output directory name
#subsample_data = false          # Whether to subsample the data for dev
#min_counts = 15                 # Minimum number of counts required to keep a cell
#min_cells = 100                 # Minimum number of cells that express the gene
#min_cell_area = 20              # Minimum cell area to filter cells
#max_cell_area = 1000            # Maximum cell area to filter cells
#norm_approach = "cell_area"     # Normalization approach to use
#remove_cells = []               # List of cell IDs to remove from the dataset

# DENOISE MODULE
# [modules.denoise_resolvi]
# module_name = "denoise_resolvi" # Name of the module - will be used in the output
# n_latent = 30
# max_epochs = 400


# DIMENSION REDUCTION MODULE
[modules.dimension_reduction]
module_name = "dimension_reduction" # Name of the module - will be used in the output directory name
norm_approach = "cell_area" # Normalization approach to use
n_pca = 40 # number of principal components to use for neighborhood graph
n_neighbors = 20 # number of neighbors for the neighborhood graph
resolution = 0.4 # resolution for leiden clustering
cluster_name = "leiden" # name of the cluster column in adata.obs
obs_vis_list = ["batch", "sample_ID", "condition", "timepoint", "ROI"]
marker_genes = [
    "PTPRC",
    "CD3E",
    "CD68",
    "EPCAM",
    "KRT5",
    "PDGFRA",
    "ACTA2",
    "VWF",
] # Cell type marker plots


# ANNOTATION MODULE
[modules.annotate]
module_name = "annotate"
cluster_name = "leiden_igraph"   # has the igraph annotation
clusters_label = "leiden_igraph" # haven't done manual annotation
# cluster_to_cell_type mapping is optional - remove this line if you don't want to rename clusters

# VIEW IMAGE MODULE
[modules.view_images]
module_name = "view_images"
cluster_name = "leiden_igraph"
gene_list = [
    "SPP1",
    "CD68",
    "MRC1",
    "CTHRC1",
    "COL1A1",
    "PDGFRA",
    "CD3E",
    "CD8A",
    "CD8B",
]
